{"ast":null,"code":"// src/api.js\nimport mockData from\"./mock-data\";export const extractLocations=events=>{const extractedLocations=events.map(event=>event.location);const locations=[...new Set(extractedLocations)];return locations;};const checkToken=async accessToken=>{const response=await fetch(\"https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=\".concat(accessToken));const result=await response.json();return result;};export const getAccessToken=async()=>{const accessToken=localStorage.getItem(\"access_token\");const tokenCheck=accessToken&&(await checkToken(accessToken));if(!accessToken||tokenCheck.error){await localStorage.removeItem(\"access_token\");const searchParams=new URLSearchParams(window.location.search);const code=await searchParams.get(\"code\");if(!code){const response=await fetch(\"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\");const result=await response.json();const{authUrl}=result;return window.location.href=authUrl;}return code&&getToken(code);}return accessToken;};const getToken=async code=>{const encodeCode=encodeURIComponent(code);const response=await fetch(\"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/token\"+\"/\"+encodeCode);const{access_token}=await response.json();access_token&&localStorage.setItem(\"access_token\",access_token);return access_token;};export const getEvents=async()=>{if(window.location.href.startsWith(\"http://localhost\")){return mockData;}const token=await getAccessToken();if(token){removeQuery();const url=\"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\"+\"/\"+token;const response=await fetch(url);const result=await response.json();if(result){return result.events;}else{return null;}}};const removeQuery=()=>{let newurl;if(window.history.pushState&&window.location.pathname){newurl=window.location.protocol+\"//\"+window.location.host+window.location.pathname;window.history.pushState(\"\",\"\",newurl);}else{newurl=window.location.protocol+\"//\"+window.location.host;window.history.pushState(\"\",\"\",newurl);}};","map":{"version":3,"names":["mockData","extractLocations","events","extractedLocations","map","event","location","locations","Set","checkToken","accessToken","response","fetch","concat","result","json","getAccessToken","localStorage","getItem","tokenCheck","error","removeItem","searchParams","URLSearchParams","window","search","code","get","authUrl","href","getToken","encodeCode","encodeURIComponent","access_token","setItem","getEvents","startsWith","token","removeQuery","url","newurl","history","pushState","pathname","protocol","host"],"sources":["/Users/clayduplantis/Documents/GitHub/meet/src/api.js"],"sourcesContent":["// src/api.js\n\nimport mockData from \"./mock-data\";\n\nexport const extractLocations = (events) => {\n  const extractedLocations = events.map((event) => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\n\nconst checkToken = async (accessToken) => {\n  const response = await fetch(\n    `https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`\n  );\n  const result = await response.json();\n  return result;\n};\n\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem(\"access_token\");\n\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = await searchParams.get(\"code\");\n\n    if (!code) {\n      const response = await fetch(\n        \"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\"\n      );\n      const result = await response.json();\n      const { authUrl } = result;\n      return (window.location.href = authUrl);\n    }\n\n    return code && getToken(code);\n  }\n\n  return accessToken;\n};\n\nconst getToken = async (code) => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(\n    \"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/token\" +\n      \"/\" +\n      encodeCode\n  );\n  const { access_token } = await response.json();\n  access_token && localStorage.setItem(\"access_token\", access_token);\n\n  return access_token;\n};\n\nexport const getEvents = async () => {\n  if (window.location.href.startsWith(\"http://localhost\")) {\n    return mockData;\n  }\n\n  const token = await getAccessToken();\n\n  if (token) {\n    removeQuery();\n    const url =\n      \"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\" +\n      \"/\" +\n      token;\n    const response = await fetch(url);\n    const result = await response.json();\n    if (result) {\n      return result.events;\n    } else {\n      return null;\n    }\n  }\n};\n\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl =\n      window.location.protocol +\n      \"//\" +\n      window.location.host +\n      window.location.pathname;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = window.location.protocol + \"//\" + window.location.host;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}