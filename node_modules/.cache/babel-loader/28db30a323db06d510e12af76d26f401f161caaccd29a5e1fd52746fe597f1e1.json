{"ast":null,"code":"import mockData from\"./mock-data\";export const extractLocations=events=>{const extractedLocations=events.map(event=>event.location);const locations=[...new Set(extractedLocations)];return locations;};const checkToken=async accessToken=>{const response=await fetch(\"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/token/\");const result=await response.json();return result;};export const getAccessToken=async()=>{const accessToken=localStorage.getItem(\"access_token\");const tokenCheck=accessToken&&(await checkToken(accessToken));if(!accessToken||tokenCheck.error){await localStorage.removeItem(\"access_token\");const searchParams=new URLSearchParams(window.location.search);const code=await searchParams.get(\"code\");if(!code){const response=await fetch(\"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\");const result=await response.json();const{authUrl}=result;return window.location.href=authUrl;}return code&&getToken(code);}return accessToken;};export const getEvents=async()=>{if(window.location.href.startsWith(\"http://localhost\")){return mockData;}const token=await getAccessToken();if(token){removeQuery();const url=\"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\"+\"/\"+token;const response=await fetch(url);const result=await response.json();if(result){return result.events;}else return null;}};const removeQuery=()=>{let newurl;if(window.history.pushState&&window.location.pathname){newurl=window.location.protocol+\"//\"+window.location.host+window.location.pathname;window.history.pushState(\"\",\"\",newurl);}else{newurl=window.location.protocol+\"//\"+window.location.host;window.history.pushState(\"\",\"\",newurl);}};const getToken=async code=>{const encodeCode=encodeURIComponent(code);const response=await fetch(\"YOUR_GET_ACCESS_TOKEN_ENDPOINT\"+\"/\"+encodeCode);const{access_token}=await response.json();access_token&&localStorage.setItem(\"access_token\",access_token);return access_token;};","map":{"version":3,"names":["mockData","extractLocations","events","extractedLocations","map","event","location","locations","Set","checkToken","accessToken","response","fetch","result","json","getAccessToken","localStorage","getItem","tokenCheck","error","removeItem","searchParams","URLSearchParams","window","search","code","get","authUrl","href","getToken","getEvents","startsWith","token","removeQuery","url","newurl","history","pushState","pathname","protocol","host","encodeCode","encodeURIComponent","access_token","setItem"],"sources":["/Users/clayduplantis/Documents/GitHub/meet/src/api.js"],"sourcesContent":["import mockData from \"./mock-data\";\n\nexport const extractLocations = (events) => {\n  const extractedLocations = events.map((event) => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\n\nconst checkToken = async (accessToken) => {\n  const response = await fetch(\n    \"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/token/\"\n  );\n  const result = await response.json();\n  return result;\n};\n\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem(\"access_token\");\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = await searchParams.get(\"code\");\n    if (!code) {\n      const response = await fetch(\n        \"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-auth-url\"\n      );\n      const result = await response.json();\n      const { authUrl } = result;\n      return (window.location.href = authUrl);\n    }\n    return code && getToken(code);\n  }\n  return accessToken;\n};\n\nexport const getEvents = async () => {\n  if (window.location.href.startsWith(\"http://localhost\")) {\n    return mockData;\n  }\n\n  const token = await getAccessToken();\n\n  if (token) {\n    removeQuery();\n    const url =\n      \"https://k6z8ae60ne.execute-api.eu-central-1.amazonaws.com/dev/api/get-events\" +\n      \"/\" +\n      token;\n    const response = await fetch(url);\n    const result = await response.json();\n    if (result) {\n      return result.events;\n    } else return null;\n  }\n};\n\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl =\n      window.location.protocol +\n      \"//\" +\n      window.location.host +\n      window.location.pathname;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = window.location.protocol + \"//\" + window.location.host;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\n\nconst getToken = async (code) => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(\n    \"YOUR_GET_ACCESS_TOKEN_ENDPOINT\" + \"/\" + encodeCode\n  );\n  const { access_token } = await response.json();\n  access_token && localStorage.setItem(\"access_token\", access_token);\n\n  return access_token;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}